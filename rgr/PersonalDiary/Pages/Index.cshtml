@page
@model PersonalDiary.Pages.IndexModel
@using PersonalDiary.Models
@using Microsoft.Extensions.Options
@inject IOptions<PersonalDiary.Models.AdminSettings> AdminSettings

<h1>–ú–æ–π –ª–∏—á–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</h1>

@if (User.Identity.IsAuthenticated && User.Identity.Name == AdminSettings.Value.AdminEmail)
{
    <a asp-page="/DiaryPosts/Create" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å</a>

    <form method="get" class="mt-3">
        <label for="category">–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</label>
        <select id="category" name="SelectedCategory" class="form-control">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            @foreach (var category in Model.DiaryPosts.Select(p => p.Category).Distinct())
            {
                <option value="@category" selected="@(Model.SelectedCategory == category)">
                    @category
                </option>
            }
        </select>
        <button type="submit" class="btn btn-info mt-2">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        <a href="/" class="btn btn-secondary mt-2">–°–±—Ä–æ—Å–∏—Ç—å</a>
    </form>

    @foreach (var DiaryPost in Model.DiaryPosts)
    {
        <div>
            <h2>@DiaryPost.Title</h2>
            <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> @DiaryPost.Category</p>
             <p>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: 
                @switch (DiaryPost.Mood)
                {
                    case "–û—Ç–ª–∏—á–Ω–æ":
                        @:üòÄ –û—Ç–ª–∏—á–Ω–æ
                        break;
                    case "–•–æ—Ä–æ—à–æ":
                        @:üòä –•–æ—Ä–æ—à–æ
                        break;
                    case "–ù–æ—Ä–º–∞–ª—å–Ω–æ":
                        @:üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ
                        break;
                    case "–ü–ª–æ—Ö–æ":
                        @:üòü –ü–ª–æ—Ö–æ
                        break;
                    case "–£–∂–∞—Å–Ω–æ":
                        @:üò≠ –£–∂–∞—Å–Ω–æ
                        break;
                }
            </p>
            <p><pre>@DiaryPost.Content</pre></p>
           
            @if (DiaryPost.UpdatedAt != default(DateTime)) 
            {
                <p><small>–ò–∑–º–µ–Ω–µ–Ω–æ: @DiaryPost.UpdatedAt.ToString("dd.MM.yyyy HH:mm")</small></p>
            }
            <p><small>–°–æ–∑–¥–∞–Ω: @DiaryPost.CreatedAt.ToString("dd.MM.yyyy HH:mm")</small></p>
            <br>

            @if (User.Identity.IsAuthenticated && User.Identity.Name == AdminSettings.Value.AdminEmail)
            {
                <a asp-page="/DiaryPosts/Edit" asp-route-id="@DiaryPost.Id" class="btn btn-warning">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a asp-page="/DiaryPosts/Delete" asp-route-id="@DiaryPost.Id" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</a>
            }
        </div>
        <hr />
    }
}
else
{
    <p>–≠—Ç–æ –ª–∏—á–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø.</p>
}
